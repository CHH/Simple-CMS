<?phpclass Spark_Controller extends Zend_Controller_Action{    protected $_models = array();      /**   * _allow()   * Allows single Actions to be accessed without authentication   * If _allow() is called without params, all actions require authentication.   * @param array $allowed An array of Action Names    *                       which should not require Authentification   */  protected function _allow($allowed=null)  {        $requestedAction = $this->getRequest()->getActionName();        $auth = Zend_Auth::getInstance();        if( !$auth->hasIdentity() ) {      if( is_array($allowed) ) {        if( !in_array($requestedAction,$allowed) ) {          $this->_helper->getHelper("Redirector")->gotoRoute(array(),"login");        }      } elseif(null !== $allowed) {        throw new Exception("List of Actions must be an Array or NULL.");      } else {        $this->_helper->getHelper("Redirector")->gotoRoute(array(),"login");      }    }      }    /**    * _getModel() - Returns an instance of the specified Model Class   * @param string $model Name of the Model, without the "Model_" prefix   * @return Model_$model   */   protected function _getModel($model, $module="default")  {    $modelClass = "Model_".$model;        $modelClass = ucfirst($module)."_".$modelClass;        if(!in_array($modelClass,$this->_models)) {      if(require_once APPLICATION_PATH . DS . "modules" . DS . $module . DS ."models"         . DS .$model . ".php") {        $this->_models[$modelClass] = new $modelClass;      } else {        throw new PropertyNotFoundException("Model {$model} not found in module {$module}");      }    }        return $this->_models[$modelClass];  }    /**   * __get() - Magic function which gets called if a property was not found   * @param string $var Name of the requested property   * @return mixed    */  public function __get($var)  {    try {      $var = $this->_getModel($var);    } catch(PropertyNotFoundException $e) {          }    return $var;  }  }?>