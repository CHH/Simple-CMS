<?phpclass Spark_View_Helper_Gravatar extends Zend_View_Helper_Abstract{    protected $_gravatarUrl;  protected $_email;  protected $_title;    public function gravatar($email, $size=48, $title=null)  {    if(null !== $email) {      $this->_gravatarUrl = "http://www.gravatar.com/avatar.php?gravatar_id=".md5(strtolower($email))."&size=".$size;            $this->_email = $email;    } else {      throw new Zend_Exception("You have to supply an E-Mail address to get a gravatar.");    }        if(null === $title) {      $this->_title = "Gravatar for {$this->_email}";    }    $this->_title = $title;        return $this;  }    public function toImage()  {    $img = "<img src=\"{$this->_gravatarUrl}\" alt=\"{$this->_email}\" title=\"{$this->_title}\" class=\"gravatar\" />";        unset($this->_gravatarUrl);    unset($this->_email);        return $img;  }    public function __toString()  {    return $this->_gravatarUrl;  }}?>